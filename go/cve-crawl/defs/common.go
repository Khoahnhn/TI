package defs

import "gitlab.viettelcyber.com/awesome-threat/library/clock"

type (
	SourceType string
	Source     string
)

const (
	// Worker name
	WorkerCveCrawler    = "CVE-CRAWLER"
	WorkerCveParser     = "CVE-PARSER"
	WorkerCveAnalyzer   = "CVE-ANALYZER"
	WorkerCveMapping    = "CVE-MAPPING"
	WorkerCveRecheck    = "CVE-RECHECK"
	WorkerCveCrawlerAPI = "CVE-CRAWLER_API"
	WorkerCveEpss       = "CVE-EPSS"
	WorkerCwe           = "CWE"
	TaskNotify          = "TASK-NOTIFY"
	// Path
	DefaultConfigFilePath       = "./config.yaml"
	DefaultTLDCacheFilePath     = "./tld.cache"
	DefaultTempFolder           = "./temp/%s"
	DefaultNotifyConfigFilePath = "./notify-config.json"
	// Common
	SourceNameNVD                  = "nvd@nist.gov"
	SourceNVD                      = "nvd"
	SourceCNA                      = "cna"
	SourceTypePrimary   SourceType = "Primary"
	SourceTypeSecondary SourceType = "Secondary"
	DefaultTimeout                 = 20
	DefaultSchedule                = 2
	DefaultRetry                   = 3
	DefaultChecker                 = "Unknown"
	TypeCveRawHistory              = "cve-raw-history"
	TypeCveRaw                     = "cve-raw"
	TypeCveApiHistory              = "cve-api-history"
	TypeCve                        = "cve"
	TypeCpe                        = "cpe"
	// Status
	StatusPending         = "pending"
	StatusDone            = "done"
	StatusApproved        = "approved"
	StatusCodeUnknown     = 0
	StatusCodeNew         = 1
	StatusCodeApproved    = 2
	StatusCodeWaitApprove = 3
	StatusCodeDelivery    = 4
	StatusCodeReject      = 5
	// Action
	ActionMonitor   = "monitor"
	ActionWhitelist = "whitelist"
	// Severity
	SeverityCodeUnknown   = 0
	SeverityCodeLow       = 1
	SeverityCodeMedium    = 2
	SeverityCodeHigh      = 3
	SeverityCodeCritical  = 4
	TitleSeverityUnknown  = "Unknown"
	TitleSeverityLow      = "Low"
	TitleSeverityMedium   = "Medium"
	TitleSeverityHigh     = "High"
	TitleSeverityCritical = "Critical"
	// Vendor
	TitleVendorUnknown = "Unknown"
	// Asset Type
	TypeAssetProduct = "product"
	// Version
	VersionCvssV20 = "2.0"
	VersionCvssV30 = "3.0"
	VersionCvssV31 = "3.1"
	VersionCvssV40 = "4.0"
	VersionVcs10   = "1.0"
	// Point
	PointNil = -1
	// Language
	LangVi = "vi"
	LangEn = "en"

	TimeoutNotify     = clock.Minute
	ScheduleNotify    = clock.Minute * 30
	URLNotify         = "http://op.vti.com/#/manage-cve"
	TitleNotify       = "Có %d cảnh báo (CVE) mới cần xử lý"
	DescriptionNotify = "Nội dung vận hành:\n" +
		"• Số lượng cảnh báo: %d\n" +
		"• Link: %s\n" +
		"• Kiểm tra các CVE mới trong portal vận hành"
	RuleID                      = "compromised_system"
	OrganizationGroup           = "visc"
	SourceLog                   = "threat_intelligence"
	ProductVendor               = "threat_intelligence"
	ProductName                 = "compromised_system"
	ProductVersion              = "1.0"
	VulnerabilityStatusRejected = "Rejected"
	TlpCacheFile                = "tld.cache"

	PermissionViewVul = "view_vul"

	CVE_EVENT_RECEIVED        = "CVE Received"
	CVE_EVENT_CISA_KEY_UPDATE = "CVE CISA KEV Update"
	ES_MAX_SEARCH_TERMS       = 10000
)

var (
	MappingSeverityToCode = map[string]int{
		"unknown":  0,
		"low":      1,
		"medium":   2,
		"high":     3,
		"critical": 4,
	}
)
