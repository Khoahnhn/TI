package model

import (
	"cve-crawler/defs"
	"strings"
)

type (
	CVSSV2 struct {
		Vector                  CVSSV2Vector `json:"cvssV2"`
		Severity                string       `json:"severity"`
		ExploitabilityScore     float32      `json:"exploitabilityScore"`
		ImpactScore             float32      `json:"impactScore"`
		AcInsufInfo             bool         `json:"acInsufInfo"`
		ObtainAllPrivilege      bool         `json:"obtainAllPrivilege"`
		ObtainUserPrivilege     bool         `json:"obtainUserPrivilege"`
		ObtainOtherPrivilege    bool         `json:"obtainOtherPrivilege"`
		UserInteractionRequired bool         `json:"userInteractionRequired"`
	}

	CVSSV2API struct {
		Vector                  CVSSV2Vector    `json:"cvssData"`
		Severity                string          `json:"baseSeverity"`
		ExploitabilityScore     float32         `json:"exploitabilityScore"`
		ImpactScore             float32         `json:"impactScore"`
		AcInsufInfo             bool            `json:"acInsufInfo"`
		ObtainAllPrivilege      bool            `json:"obtainAllPrivilege"`
		ObtainUserPrivilege     bool            `json:"obtainUserPrivilege"`
		ObtainOtherPrivilege    bool            `json:"obtainOtherPrivilege"`
		UserInteractionRequired bool            `json:"userInteractionRequired"`
		Source                  string          `json:"source"`
		Type                    defs.SourceType `json:"type"`
	}

	CVSSV2Vector struct {
		Version               string  `json:"version"`
		VectorString          string  `json:"vectorString"`
		AccessVector          string  `json:"accessVector"`
		AccessComplexity      string  `json:"accessComplexity"`
		Authentication        string  `json:"authentication"`
		ConfidentialityImpact string  `json:"confidentialityImpact"`
		IntegrityImpact       string  `json:"integrityImpact"`
		AvailabilityImpact    string  `json:"availabilityImpact"`
		BaseScore             float32 `json:"baseScore"`
	}
)

func (doc *CVSSV2Vector) Result() map[string]interface{} {
	// Success
	return map[string]interface{}{
		"Access Vector":          strings.Title(strings.ToLower(doc.AccessVector)),
		"Access Complexity":      strings.Title(strings.ToLower(doc.AccessComplexity)),
		"Authentication":         strings.Title(strings.ToLower(doc.Authentication)),
		"Availability Impact":    strings.Title(strings.ToLower(doc.AvailabilityImpact)),
		"Confidentiality Impact": strings.Title(strings.ToLower(doc.ConfidentialityImpact)),
		"Integrity Impact":       strings.Title(strings.ToLower(doc.IntegrityImpact)),
	}
}
