package model

import (
	"gitlab.viettelcyber.com/awesome-threat/library/clock"
)

type (
	GroupUser struct {
		ID          string   `json:"id" bson:"_id"`
		TenantID    string   `json:"tenant_id" bson:"tenant_id"`
		Ancestors   []string `json:"ancestors" bson:"ancestors"`
		Parent      string   `json:"parent" bson:"parent"`
		Name        string   `json:"name" bson:"name"`
		Industry    []string `json:"industry" bson:"industry"`
		Active      bool     `json:"active" bson:"active"`
		ExpiredTime int64    `json:"expired_time" bson:"expired_time"`
		Role        string   `json:"role" bson:"role"`
		Permissions []string `json:"permissions" bson:"-"`
		Mass        bool     `json:"mass" bson:"-"`
	}

	GroupUserSummary struct {
		ID        string   `json:"id"`
		Name      string   `json:"name"`
		Parent    string   `json:"parent"`
		Ancestors []string `json:"ancestors"`
	}
)

func (doc *GroupUser) IsActive() bool {
	if !doc.Active {
		return false
	}
	if doc.ExpiredTime == 0 {
		return true
	}
	now, _ := clock.Now(clock.Local)
	// Success
	return clock.Unix(now) < doc.ExpiredTime
}
