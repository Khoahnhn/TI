package elastic

import (
	"context"

	"gitlab.viettelcyber.com/awesome-threat/library/adapter/elastic"

	"gitlab.viettelcyber.com/ti-micro/ws-threat/defs"
	"gitlab.viettelcyber.com/ti-micro/ws-threat/model"
)

type cveLifecycleRepository struct {
	con elastic.Service
}

func NewCVELifecycleRepository(conf elastic.Config) CVELifecycleRepository {
	// Success
	return &cveLifecycleRepository{con: elastic.NewService(conf)}
}

func (inst *cveLifecycleRepository) Name() string {
	// Success
	return defs.IndexCveLifeCycle
}

func (inst *cveLifecycleRepository) Store(ctx context.Context, document *model.CVELifecycle) error {
	if err := inst.con.InsertOne(inst.Name(), "", document); err != nil {
		return err
	}
	// Success
	return nil
}
